<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ user.first_name }} Profiles</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
      crossorigin="anonymous"
    ></script>
    <style>
      H4 {
        display: inline;
      }

      body {
        background-image: url("../static/images/background.jpg");
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: center;
      }
    </style>
  </head>
  <body class="bg-dark">
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarTogglerDemo01"
          aria-controls="navbarTogglerDemo01"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
          <a href="/"
            ><img
              src="{{ url_for('static', filename = 'images/bloglite.gif') }}"
              class="navbar-brand"
              width="200"
              height="60"
          /></a>
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/post"
                ><svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-plus-circle-dotted"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M8 0c-.176 0-.35.006-.523.017l.064.998a7.117 7.117 0 0 1 .918 0l.064-.998A8.113 8.113 0 0 0 8 0zM6.44.152c-.346.069-.684.16-1.012.27l.321.948c.287-.098.582-.177.884-.237L6.44.153zm4.132.271a7.946 7.946 0 0 0-1.011-.27l-.194.98c.302.06.597.14.884.237l.321-.947zm1.873.925a8 8 0 0 0-.906-.524l-.443.896c.275.136.54.29.793.459l.556-.831zM4.46.824c-.314.155-.616.33-.905.524l.556.83a7.07 7.07 0 0 1 .793-.458L4.46.824zM2.725 1.985c-.262.23-.51.478-.74.74l.752.66c.202-.23.418-.446.648-.648l-.66-.752zm11.29.74a8.058 8.058 0 0 0-.74-.74l-.66.752c.23.202.447.418.648.648l.752-.66zm1.161 1.735a7.98 7.98 0 0 0-.524-.905l-.83.556c.169.253.322.518.458.793l.896-.443zM1.348 3.555c-.194.289-.37.591-.524.906l.896.443c.136-.275.29-.54.459-.793l-.831-.556zM.423 5.428a7.945 7.945 0 0 0-.27 1.011l.98.194c.06-.302.14-.597.237-.884l-.947-.321zM15.848 6.44a7.943 7.943 0 0 0-.27-1.012l-.948.321c.098.287.177.582.237.884l.98-.194zM.017 7.477a8.113 8.113 0 0 0 0 1.046l.998-.064a7.117 7.117 0 0 1 0-.918l-.998-.064zM16 8a8.1 8.1 0 0 0-.017-.523l-.998.064a7.11 7.11 0 0 1 0 .918l.998.064A8.1 8.1 0 0 0 16 8zM.152 9.56c.069.346.16.684.27 1.012l.948-.321a6.944 6.944 0 0 1-.237-.884l-.98.194zm15.425 1.012c.112-.328.202-.666.27-1.011l-.98-.194c-.06.302-.14.597-.237.884l.947.321zM.824 11.54a8 8 0 0 0 .524.905l.83-.556a6.999 6.999 0 0 1-.458-.793l-.896.443zm13.828.905c.194-.289.37-.591.524-.906l-.896-.443c-.136.275-.29.54-.459.793l.831.556zm-12.667.83c.23.262.478.51.74.74l.66-.752a7.047 7.047 0 0 1-.648-.648l-.752.66zm11.29.74c.262-.23.51-.478.74-.74l-.752-.66c-.201.23-.418.447-.648.648l.66.752zm-1.735 1.161c.314-.155.616-.33.905-.524l-.556-.83a7.07 7.07 0 0 1-.793.458l.443.896zm-7.985-.524c.289.194.591.37.906.524l.443-.896a6.998 6.998 0 0 1-.793-.459l-.556.831zm1.873.925c.328.112.666.202 1.011.27l.194-.98a6.953 6.953 0 0 1-.884-.237l-.321.947zm4.132.271a7.944 7.944 0 0 0 1.012-.27l-.321-.948a6.954 6.954 0 0 1-.884.237l.194.98zm-2.083.135a8.1 8.1 0 0 0 1.046 0l-.064-.998a7.11 7.11 0 0 1-.918 0l-.064.998zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"
                  />
                </svg>
                New Post</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/search"
                ><svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="currentColor"
                  class="bi bi-search"
                  viewBox="0 0 16 16"
                >
                  <path
                    d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
                  />
                </svg>
                Search</a
              >
            </li>
          </ul>
          <a class="btn btn-primary" href="/logout">Logout</a>
        </div>
      </div>
    </nav>
    {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %} {% for category, message in messages %} {% if category ==
    'warning' %}

    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      <strong>{{ message }}</strong>
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="alert"
        aria-label="Close"
      ></button>
    </div>

    {% else %}

    <div class="alert alert-success alert-dismissible fade show" role="alert">
      <strong>{{ message }}</strong>
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="alert"
        aria-label="Close"
      ></button>
    </div>
    {% endif %} {% endfor %} {% endif %} {% endwith %}
    <section class="h-100">
      <div class="container py-5 h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
          <div class="col col-lg-9 col-xxl-7">
            <div class="card">
              <div
                class="rounded-top text-white d-flex flex-row"
                style="
                  background-color: rgba(193, 57, 211, 0.644);
                  height: 200px;
                "
              >
                <div class="ms-4 mt-5 d-flex flex-column" style="width: 150px">
                  {% if user.profile_pic %}
                  <img
                    src="{{profile_image}}"
                    alt="Generic placeholder image"
                    class="img-fluid img-thumbnail mt-4 mb-3"
                    style="width: auto; z-index: 1; height: 200px; object-fit: cover;"
                  />
                  {% else %}
                  <img
                    src="{{ url_for('static', filename = 'images/default_profile.png') }}"
                    alt="Generic placeholder image"
                    class="img-fluid img-thumbnail mt-4 mb-2"
                    style="width: 150px; z-index: 1"
                  />
                  {% endif %}
                </div>
                <div class="ms-4" style="margin-top: 130px">
                  <h5>{{ user.first_name }}</h5>
                  <span>@{{ user.username }}</span>
                </div>
              </div>
              <div class="p-4 text-black" style="background-color: #f8fafa">
                <div class="d-flex justify-content-end text-center py-1">
                  <div>
                    <p class="mb-1 h4">{{ count }}</p>
                    <h7 class="mt-5">Posts</h7>
                  </div>
                  <div class="px-5">
                    <p class="mb-1 h4">{{ user.followers.count() }}</p>
                    <div class="dropdown">
                      <button
                        class="btn btn-light btn-sm dropdown-toggle"
                        type="button"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                      >
                        Followed By
                      </button>
                      <ul class="dropdown-menu">
                        {% for row in users %}{% if row != current_user %} {% if
                        user.is_followed_by(row) %}
                        <li>
                          <a
                            class="dropdown-item"
                            href="/profile/{{row.username}}"
                            >{{ row.first_name }}</a
                          >
                        </li>
                        {% endif %} {% endif %} {% endfor %}
                      </ul>
                    </div>
                  </div>
                  <div>
                    <p class="mb-1 h4">{{ user.followed.count() }}</p>
                    <div class="btn-group dropend">
                      <button
                        type="button"
                        class="btn btn-light dropdown-toggle btn-sm"
                        data-bs-toggle="dropdown"
                        aria-expanded="false"
                      >
                        Following
                      </button>
                      <ul class="dropdown-menu">
                        {% for row in users %}{% if row != current_user %} {% if
                        user.is_following(row) %}
                        <li>
                          <a
                            class="dropdown-item"
                            href="/profile/{{row.username}}"
                            >{{ row.first_name }}</a
                          >
                        </li>
                        {% endif %} {% endif %} {% endfor %}
                      </ul>
                    </div>
                  </div>
                </div>
                <p>
                  <a href="/profile/{{user.id}}/update"
                    ><button type="button" class="btn btn-outline-dark mx-sm-3">
                      Update Profile
                    </button></a
                  ><button
                    type="button"
                    class="btn btn-danger"
                    data-bs-toggle="modal"
                    data-bs-target="#exampleModal"
                  >
                    Delete
                  </button>
                </p>
                <div
                  class="modal fade"
                  id="exampleModal"
                  tabindex="-1"
                  aria-labelledby="exampleModalLabel"
                  aria-hidden="true"
                >
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">
                          Account Delete Confirmation
                        </h1>
                        <button
                          type="button"
                          class="btn-close"
                          data-bs-dismiss="modal"
                          aria-label="Close"
                        ></button>
                      </div>
                      <div class="modal-body">
                        Are you sure to delete your account.
                      </div>
                      <div class="modal-footer">
                        <button
                          type="button"
                          class="btn btn-secondary"
                          data-bs-dismiss="modal"
                        >
                          Close
                        </button>
                        <a href="/profile/{{user.id}}/delete"
                          ><button type="button" class="btn btn-danger">
                            DELETE
                          </button></a
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card-body p-4 text-black">
                <div class="mb-5">
                  <p class="fst-normal fs-4">About</p>
                  <div class="p-1" style="background-color: #faf8fa">
                    <p class="mb-1">
                      Member since : {{ user.created.strftime('%d-%m-%Y') }}
                    </p>
                  </div>
                </div>
                {% if count !=0 %}
                <div class="mb-4">
                  <p class="fst-normal fs-4">Recent posts</p>
                </div>

                <div class="row g-5 d-flex justify-content-between">
                  {% for post in posts %}
                  <div class="col-lg-6">
                    <div class="card mb-5 shadow-sm">
                      {% if post.image %}
                      <img
                        src="{{ url_for('static', filename = 'blog_pics/' + post.image) }}"
                        class="img-fluid"
                        style="object-fit: cover; width: auto; height: 300px"
                      />{% else %}<img
                        src="{{ url_for('static', filename = 'images/blog-default.png') }}"
                        class="img-fluid"
                        style="object-fit: contain; width: auto; height: 300px"
                      />{% endif %}

                      <div class="card-body">
                        <a href="/posts/{{post.id}},{{post.user.username}}">
                          <div class="card-header text-center">
                            <h3>{{ post.title|truncate(20)|title }}</h3>
                          </div></a
                        >
                        <div class="card-text text-center">
                          <p>{{ post.description|truncate(200) }}</p>
                        </div>

                        {% if post.description|length() > 200 %}
                        <a
                          href="/posts/{{post.id}},{{post.user.username}}"
                          class="btn btn-primary rounded-5 float-end"
                          >Read More</a
                        >
                        {% else %} {% endif %}
                      </div>
                    </div>
                  </div>
                  {% endfor %}
                </div>
              </div>
              {% else %}
              <div class="row">
                <div class="text-warning text-center my-5">
                  <h2>You have not uploaded any post yet.</h2>
                  <a href="/post"><h4>Click here</h4></a>
                  <h4>to upload</h4>
                </div>
              </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </section>
  </body>
</html>
